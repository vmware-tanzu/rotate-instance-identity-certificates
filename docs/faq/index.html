<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.81.0" />
    <meta name="description" content="">
<meta name="author" content="VMware Tanzu">

    <link rel="icon" href="/rotate-instance-identity-certificates/images/favicon.png" type="image/png">

    <title>Frequently Asked Questions :: Rotate Instance Identity Certificates Docs</title>

    
    <link href="/rotate-instance-identity-certificates/css/nucleus.css?1614209294" rel="stylesheet">
    <link href="/rotate-instance-identity-certificates/css/fontawesome-all.min.css?1614209294" rel="stylesheet">
    <link href="/rotate-instance-identity-certificates/css/hybrid.css?1614209294" rel="stylesheet">
    <link href="/rotate-instance-identity-certificates/css/featherlight.min.css?1614209294" rel="stylesheet">
    <link href="/rotate-instance-identity-certificates/css/perfect-scrollbar.min.css?1614209294" rel="stylesheet">
    <link href="/rotate-instance-identity-certificates/css/auto-complete.css?1614209294" rel="stylesheet">
    <link href="/rotate-instance-identity-certificates/css/atom-one-dark-reasonable.css?1614209294" rel="stylesheet">
    <link href="/rotate-instance-identity-certificates/css/theme.css?1614209294" rel="stylesheet">
    <link href="/rotate-instance-identity-certificates/css/hugo-theme.css?1614209294" rel="stylesheet">
    
    <link href="/rotate-instance-identity-certificates/css/theme-blue.css?1614209294" rel="stylesheet">
    
    

    <script src="/rotate-instance-identity-certificates/js/jquery-3.3.1.min.js?1614209294"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/rotate-instance-identity-certificates/docs/faq/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <img src="https://docs.vmware.com/en/VMware-Tanzu-Kubernetes-Grid/images/GUID-8546DDD9-718A-42F7-9EDB-0BCC3A316BB6-low.png" />

    </div>
    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/rotate-instance-identity-certificates/docs/" title="Docs" class="dd-item
        parent
        
        
        ">
      <a href="/rotate-instance-identity-certificates/docs/">
          Docs
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/rotate-instance-identity-certificates/docs/overview/" title="Overview" class="dd-item ">
        <a href="/rotate-instance-identity-certificates/docs/overview/">
        Overview
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/rotate-instance-identity-certificates/docs/running/" title="Running the Tool" class="dd-item ">
        <a href="/rotate-instance-identity-certificates/docs/running/">
        Running the Tool
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/rotate-instance-identity-certificates/docs/failure/" title="Handling Failures" class="dd-item ">
        <a href="/rotate-instance-identity-certificates/docs/failure/">
        Handling Failures
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/rotate-instance-identity-certificates/docs/faq/" title="Frequently Asked Questions" class="dd-item active">
        <a href="/rotate-instance-identity-certificates/docs/faq/">
        Frequently Asked Questions
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/rotate-instance-identity-certificates/releases/" title="" class="dd-item
        
        
        
        ">
      <a href="/rotate-instance-identity-certificates/releases/">
          
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      

      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <center>
    <a class="github-button" href="https://github.com/vmware-tanzu/rotate-instance-identity-certificates/releases/latest"
        data-icon="octicon-cloud-download" aria-label="Download on GitHub">Latest Release</a>

    <a class="github-button" href="https://github.com/vmware-tanzu/rotate-instance-identity-certificates" data-icon="octicon-star"
        data-show-count="true" aria-label="Star on GitHub">Star</a>

    <a class="github-button" href="https://github.com/vmware-tanzu/rotate-instance-identity-certificates/fork" data-icon="octicon-repo-forked"
        data-show-count="true" aria-label="Fork on GitHub">Fork</a>

    <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a
            href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>
</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/vmware-tanzu/rotate-instance-identity-certificates/edit/main/docs/riic-docs/contentdocs/faq.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/rotate-instance-identity-certificates/'>Rotate Instance Identity Certificates</a> > <a href='/rotate-instance-identity-certificates/docs/'>Docs</a> > Frequently Asked Questions
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#why-must-the-tool-run-on-the-operations-manager-vm">Why must the tool run on the Operations Manager VM?</a></li>
    <li><a href="#how-long-does-the-rotation-take">How long does the rotation take?</a></li>
    <li><a href="#should-i-expect-downtime-during-the-rotation">Should I expect downtime during the rotation?</a></li>
    <li><a href="#does-this-tool-support-the-small-footprint-runtime">Does this tool support the Small Footprint Runtime?</a></li>
    <li><a href="#does-this-tool-support-isolation-segments-or-tas-for-windows">Does this tool support isolation segments or TAS for Windows?</a></li>
    <li><a href="#any-tips-for-dealing-with-the-verbosity-of-the-logs">Any tips for dealing with the verbosity of the logs?</a></li>
    <li><a href="#why-does-riic-say-there-are-pending-changes">Why does riic say there are pending changes?</a></li>
    <li><a href="#can-i-restart-a-cert-rotation-at-a-specific-step">Can I restart a cert rotation at a specific step?</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Frequently Asked Questions
            </h1>
          

        


<h2 id="why-must-the-tool-run-on-the-operations-manager-vm">Why must the tool run on the Operations Manager VM?</h2>
<p>Under the hood, we rely on the <code>bosh</code> and <code>credhub</code> CLIs. These programs are
already guaranteed to be present on the Operations Manager VM and are known to
be compatible with the currently deployed version of the platform, so we require
the tooling to run in this environment to prevent errors due to incompatible
versions or missing tools.</p>
<h2 id="how-long-does-the-rotation-take">How long does the rotation take?</h2>
<p>The rotation consists of 2 deployments, each of which must update the following instance groups:</p>
<ul>
<li>Diego Cells</li>
<li>Routers</li>
<li>Diego Brain</li>
<li>Credhub</li>
</ul>
<p>The number of cells and routers vary widely across installations, but you can
expect that an environment with a large number of cells and routers will take
much longer to rotate than a smaller environment.</p>
<h2 id="should-i-expect-downtime-during-the-rotation">Should I expect downtime during the rotation?</h2>
<p>The process is designed to maintain platform functionality.</p>
<p>The diego cells and routers do need to be updated during the rotation, so you
should ensure that any applications that cannot tolerate downtime are deployed
with more than one instance, and that your load balancer health checks are
correctly configured to detect unhealthy routers.</p>
<h2 id="does-this-tool-support-the-small-footprint-runtime">Does this tool support the Small Footprint Runtime?</h2>
<p>No.</p>
<h2 id="does-this-tool-support-isolation-segments-or-tas-for-windows">Does this tool support isolation segments or TAS for Windows?</h2>
<p>Yes. The tool will automatically detect whether isolation segments or Windows
cells are installed, and will perform the appropriate actions to rotate the
certificates on these environments as well.</p>
<h2 id="any-tips-for-dealing-with-the-verbosity-of-the-logs">Any tips for dealing with the verbosity of the logs?</h2>
<p>Yes. Output coming directly from the tool (and not from BOSH) is prefixed with &ldquo;RIIC&rdquo;
for easy grepping:</p>
<pre><code>$ grep RIIC nohup.out
</code></pre><h2 id="why-does-riic-say-there-are-pending-changes">Why does riic say there are pending changes?</h2>
<p>It&rsquo;s important that any pending changes staged in Operations Manager are applied or reverted before attempting to rotate certificates with riic. Doing otherwise may lead to downtime. You can check for pending changes in the Operations Manager UI, however some changes like stemcell updates won&rsquo;t show up here.</p>
<p>To find all pending changes open the URL <code>https://&lt;your-opsman.fqdn&gt;/api/v0/staged/pending_changes</code> from your logged in browser. In the json response look for any products that do not have an <code>action</code> of <code>unchanged</code>. That should give a clue as to what changes are actually pending and keeping riic from running. For example a stemcell update would show up with an <code>action</code> of <code>update</code>.</p>
<h2 id="can-i-restart-a-cert-rotation-at-a-specific-step">Can I restart a cert rotation at a specific step?</h2>
<p>Yes. See <a href="/rotate-instance-identity-certificates/docs/failure/">Handling Failures</a>.</p>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/rotate-instance-identity-certificates/docs/failure/" title="Handling Failures"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/rotate-instance-identity-certificates/releases/" title="" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/rotate-instance-identity-certificates/js/clipboard.min.js?1614209294"></script>
    <script src="/rotate-instance-identity-certificates/js/perfect-scrollbar.min.js?1614209294"></script>
    <script src="/rotate-instance-identity-certificates/js/perfect-scrollbar.jquery.min.js?1614209294"></script>
    <script src="/rotate-instance-identity-certificates/js/jquery.sticky.js?1614209294"></script>
    <script src="/rotate-instance-identity-certificates/js/featherlight.min.js?1614209294"></script>
    <script src="/rotate-instance-identity-certificates/js/highlight.pack.js?1614209294"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/rotate-instance-identity-certificates/js/modernizr.custom-3.6.0.js?1614209294"></script>
    <script src="/rotate-instance-identity-certificates/js/learn.js?1614209294"></script>
    <script src="/rotate-instance-identity-certificates/js/hugo-learn.js?1614209294"></script>
    
    

  </body>
</html>

